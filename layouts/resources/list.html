{{ define "main" }}

{{ .Content }}

{{ $resources := .Site.Data.resources }}
<div class="row">
  <div class="col">
    <h3 id="for-researchers">Resources</h3>
  </div>
  <div class="col-3 text-end">
    <div class="input-group">
      <span class="input-group-text"><i class="bi bi-search"></i></span>
      <input type="text" class="form-control" placeholder="Search" aria-label="Search" data-resource-area="researchers_resources">
    </div>
  </div>
</div>
<div class="mt-2">
  <p></p>
</div>
<div id="researchers_resources" class="row g-3 mb-5">
  {{ range $resources }}
  <div class="col-md-6 col-lg-4 resource" {{ with .search_tags }}data-search-tags="{{ delimit . ":" | lower }}"{{ end }}>
    <div class="bg-resource">
      <div {{ if .thumbnail_border }}class="p-1" {{ end }}>
        <a target="_self" href="{{ .url }}"><img class="img-fluid"
            src="{{ with .thumbnail }}{{ . }}{{ else }}{{ "/img/resource_thumbnails/scilifelab.jpg" }}{{ end }}"
            alt="{{ .name }}"></a>
      </div>
      <div class="p-2 bg-resource-title">
        <h5><a href="{{ .url }}" target="_self">{{ .name }}</a></h5>
      </div>
      <div class="p-2">
        {{ .description }}
      </div>
      <div class="px-2">
        <b>Type:</b> {{ delimit (apply .type "strings.FirstUpper" ".") ", " }}
      </div>
      <div class="px-2">
        <b>Maintained by:</b>
        {{ if .maintained_by_url}}
        <a href="{{ .maintained_by_url}}">{{ .maintained_by }}</a>
        {{ else }}
        {{ .maintained_by }}
        {{ end }}
      </div>
      {{ if or (or .support_email .support_website) .support_github }}
      <div class="px-2 mb-2">
        <b>Support:</b>
        {{ with .support_email }}<a href="mailto:{{ . }}"><i class="bi bi-envelope-fill"></i></a> {{ end }}
        {{ with .support_website }}<a href="{{ . }}"><i class="bi bi-globe"></i></a> {{ end }}
        {{ with .support_github }}<a href="{{ . }}"><i class="bi bi-github"></i></a> {{ end }}
      </div>
      {{ end }}
    </div>
  </div>
  <div id="no-filtered-resource" style="display:none;">
    <p class="text-center">No resources have the given keyword, please try to use another.</p>
  </div>
</div>
{{ end }}

<script>
  
  // Function to filter the resource based on search text
  $("input[type=text]").on("input", function(){
    
    // Get the text entered and resource category 
    var searchText = $(this).val().toLowerCase();
    var searchArea = this.getAttribute('data-resource-area');
    
    // Hide all resources before filtering
    $(`div#${searchArea} div.resource`).hide();
    $(`div#${searchArea} div#no-filtered-resource`).hide();
    
    // If text empty show all resources
    if (searchText == ''){
      $(`div#${searchArea} div.resource`).show();
    } else {
      $(`div#${searchArea} div[data-search-tags*='${searchText}']`).show();
      
      // Display a message if no resources available for given keyword
      var visible_resources = $(`div#${searchArea} div.resource`).filter(":visible");
      if (!visible_resources.length) {
        $(`div#${searchArea} div#no-filtered-resource`).show();
      }
    }
  });

</script>

{{ end }}
